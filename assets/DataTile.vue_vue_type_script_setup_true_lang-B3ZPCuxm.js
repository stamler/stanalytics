import{o as a,c as l,a as u,d as B,r as _,j as N,w as C,F as m,k as b,l as x,e as g,m as j,t as k,i as $,n as V,_ as O,p as F,q as D,b as L,x as S}from"./index-JEsra2oL.js";import{_ as q,J as M,f as Z,a as E}from"./tokenparser-BdKGo924.js";function R(f,e){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-.53 14.03a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72V8.25a.75.75 0 0 0-1.5 0v5.69l-1.72-1.72a.75.75 0 0 0-1.06 1.06l3 3Z","clip-rule":"evenodd"})])}function A(f,e){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{d:"M12 1.5a.75.75 0 0 1 .75.75V7.5h-1.5V2.25A.75.75 0 0 1 12 1.5ZM11.25 7.5v5.69l-1.72-1.72a.75.75 0 0 0-1.06 1.06l3 3a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72V7.5h3.75a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-9a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h3.75Z"})])}function T(f,e){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm.53 5.47a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72v5.69a.75.75 0 0 0 1.5 0v-5.69l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z","clip-rule":"evenodd"})])}function U(f,e){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[u("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z","clip-rule":"evenodd"})])}const J={key:0},H={class:"flex flex-wrap"},I={id:"tablecontainer"},P={key:0},Q=["onClick"],z={class:"inline-block h-5 w-4"},G=["onClick"],K={key:1},W=B({__name:"ObjectTable",props:{tableData:{type:Array,required:!0}},setup(f){const e=_([]),s=_(""),o=_(0),t=_(void 0),v=f,c=N(()=>t.value===void 0||t.value.length===0?[]:Object.keys(t.value[0]));C(()=>v.tableData,r=>{e.value=[],s.value="",o.value=0,t.value=r}),C([e,s,o],()=>{t.value=v.tableData,t.value=d(),p()},{deep:!0});const h=function(r){s.value=r,o.value=(o.value+1)%3},p=function(){switch(o.value){case 0:return;case 1:return t.value=q.orderBy(t.value,s.value,"asc");case 2:return t.value=q.orderBy(t.value,s.value,"desc")}},n=function(r){e.value=e.value.filter(y=>y!==r)},d=function(){return t.value===void 0?[]:t.value.filter(r=>e.value.every(y=>r[y.key]===y.value))};return(r,y)=>t.value!==void 0||Array.isArray(t.value)?(a(),l("div",J,[u("div",H,[(a(!0),l(m,null,b(e.value,i=>(a(),l("div",{class:"mb-2 mr-2 flex rounded-md border border-blue-700 bg-blue-200 px-2 py-1",key:i.key},[x(g(U),{class:"w-5 pr-1",onClick:w=>n(i)},null,8,["onClick"]),j(" "+k(i.key+": "+i.value),1)]))),128))]),u("div",I,[t.value.length>0?(a(),l("table",P,[u("thead",null,[u("tr",null,[(a(!0),l(m,null,b(c.value,i=>(a(),l("th",{class:"align-bottom",key:i},[u("a",{class:"hover:underline",title:"sort",onClick:w=>h(i)},k(i),9,Q),u("span",z,[s.value===i?(a(),l(m,{key:0},[o.value===2?(a(),$(g(R),{key:0,class:"w-5"})):o.value===1?(a(),$(g(T),{key:1,class:"w-5"})):(a(),l(m,{key:2},[],64))],64)):V("",!0)])]))),128))])]),u("tbody",null,[(a(!0),l(m,null,b(t.value,i=>(a(),l("tr",{key:i.id},[(a(!0),l(m,null,b(c.value,w=>(a(),l("td",{class:"pr-4",key:w},[u("a",{class:"hover:underline",onClick:oe=>e.value.push({key:w,value:i[w]})},k(i[w]),9,G)]))),128))]))),128))])])):(a(),l("span",K,"No Data"))])])):V("",!0)}}),X=O(W,[["__scopeId","data-v-a8221a51"]]);class Y extends M{constructor(e){super(e)}parse(e){const s=this.preprocessData(e);this.opts.fields=this.opts.fields||this.preprocessFieldsInfo(s.reduce((c,h)=>(Object.keys(h).forEach(p=>{c.includes(p)||c.push(p)}),c),[]),this.opts.defaultValue);const o=this.opts.header?this.getHeader():"",t=this.processData(s);return(this.opts.withBOM?"\uFEFF":"")+o+(o&&t?this.opts.eol:"")+t}preprocessData(e){const s=Array.isArray(e)?e:[e];if(!this.opts.fields){if(e==null||s.length===0)throw new Error('Data should not be empty or the "fields" option should be included');if(typeof s[0]!="object")throw new Error('Data items should be objects or the "fields" option should be included')}return this.opts.transforms.length===0?s:s.map(o=>this.preprocessRow(o)).reduce(Z,[])}processData(e){return E(e.map(s=>this.processRow(s)).filter(s=>s),this.opts.eol)}}const ee={key:0},te=B({__name:"DownloadData",props:{query:null,dlFileName:{type:String,required:!1}},setup(f){const e=_(!1),s=f,o=async function(){e.value=!0;const v=await s.query,h=new Y().parse(v),p=new Blob([h],{type:"text/csv"}),n=s.dlFileName||"report.csv";t(p,n),e.value=!1},t=function(v,c,h=!1){const p=URL.createObjectURL(v),n=document.createElement("a");n.href=p,h||(n.download=c||"download");const d=()=>{setTimeout(()=>{URL.revokeObjectURL(p),n.removeEventListener("click",d)},150)};return n.addEventListener("click",d,!1),n.click(),n};return(v,c)=>e.value?(a(),l("span",ee,"Loading...")):(a(),l("a",{key:1,type:"download",title:"download report",onClick:c[0]||(c[0]=h=>o())},[x(g(A),{class:"inline-block h-8 w-8 text-blue-500 hover:text-blue-800"})]))}}),ae={class:"bg-yellow-400 p-4 text-2xl font-bold"},se=["value"],le=u("label",{for:"date"},"Date",-1),re=["value"],ce=B({__name:"DataTile",props:{title:{type:String,required:!0},table:{type:String,required:!0}},setup(f){const e=_(""),s=_([]),o=_([]),t=_(""),v=_([]),c=f;async function h(){const n=D.from(c.table).select().eq("supplier",e.value).eq("date",t.value),{data:d}=await n;v.value=d}F(async()=>{var r,y;const{data:n}=await D.from("sqdc_suppliers").select();s.value=n||void 0,e.value=((r=s.value)==null?void 0:r[0].supplier)||"";const{data:d}=await D.from("sqdc_inventory_changes_dates").select();o.value=d,t.value=((y=o.value)==null?void 0:y[1].date)||"",h()}),C([e,t],()=>{h()});const p=N(()=>v.value?v.value.map(n=>q.omit(n,["supplier"])):[]);return(n,d)=>(a(),l("div",null,[u("h1",ae,[j(k(c.title)+" ",1),x(te,{query:p.value,dlFileName:c.title+".csv"},null,8,["query","dlFileName"])]),L(u("select",{"onUpdate:modelValue":d[0]||(d[0]=r=>e.value=r)},[(a(!0),l(m,null,b(s.value,r=>(a(),l("option",{key:r.supplier||void 0,value:r.supplier},k(r.supplier),9,se))),128))],512),[[S,e.value]]),u("div",null,[le,L(u("select",{"onUpdate:modelValue":d[1]||(d[1]=r=>t.value=r)},[(a(!0),l(m,null,b(o.value,r=>(a(),l("option",{key:r.date||void 0,value:r.date},k(r.date),9,re))),128))],512),[[S,t.value]])]),x(X,{tableData:p.value},null,8,["tableData"])]))}});export{ce as _};
