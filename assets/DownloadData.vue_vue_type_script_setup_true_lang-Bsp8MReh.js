import{o,c as i,a as F,d as B,r as m,k as b,e as g}from"./index-Cs6w6jFr.js";function v(_,E){return o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[F("path",{d:"M12 1.5a.75.75 0 0 1 .75.75V7.5h-1.5V2.25A.75.75 0 0 1 12 1.5ZM11.25 7.5v5.69l-1.72-1.72a.75.75 0 0 0-1.06 1.06l3 3a.75.75 0 0 0 1.06 0l3-3a.75.75 0 1 0-1.06-1.06l-1.72 1.72V7.5h3.75a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-9a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h3.75Z"})])}function l(_){return _==null?"":`${_}`}function H(_={}){const{separator:E,decimals:L}=_;return E?L?A=>A.toFixed(L).replace(".",E):A=>`${A}`.replace(".",E):L?A=>A.toFixed(L):A=>`${A}`}function S(_={}){const E=typeof _.quote=="string"?_.quote:'"',L=typeof _.escapedQuote=="string"?_.escapedQuote:`${E}${E}`;if(!E||E===L)return T=>T;const A=new RegExp(E,"g");return T=>(T.includes(E)&&(T=T.replace(A,L)),`${E}${T}${E}`)}function w(_={stringFormatter:S()}){return E=>_.stringFormatter(E.toString().slice(7,-1))}function K(_={stringFormatter:S()}){return E=>{if(E===null)return"";let L=JSON.stringify(E);return L===void 0?"":(L[0]==='"'&&(L=L.replace(/^"(.+)"$/,"$1")),_.stringFormatter(L))}}const V=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function Q(_){var E,L,A;const T=[];let I;for(;I=V.exec(_);)T.push((A=(E=I[3])!==null&&E!==void 0?E:(L=I[1])===null||L===void 0?void 0:L.trim())!==null&&A!==void 0?A:I[0]);return T}function d(_,E,L){if(E in _){const I=_[E];return I===void 0?L:I}const A=Array.isArray(E)?E:Q(E);let T=_;for(const I of A)if(T=T==null?void 0:T[I],T===void 0)return L;return T}function p(_,E){try{return Array.isArray(E)?_.push(...E):_.push(E),_}catch{return _.concat(E)}}function M(_,E){let L=!0;return _.reduce((A,T)=>(T==null&&(T=""),L?(L=!1,`${T}`):`${A}${E}${T}`),"")}var f;(function(_){_.header="header",_.undefined="undefined",_.boolean="boolean",_.number="number",_.bigint="bigint",_.string="string",_.symbol="symbol",_.function="function",_.object="object"})(f||(f={}));class r{constructor(E){this.opts=this.preprocessOpts(E)}preprocessOpts(E){const L=Object.assign({},E);L.fields&&(L.fields=this.preprocessFieldsInfo(L.fields,L.defaultValue)),L.transforms=L.transforms||[];const A=L.formatters&&L.formatters.string||S(),T=K({stringFormatter:A}),I={header:A,undefined:l,boolean:l,number:H(),bigint:l,string:A,symbol:w({stringFormatter:A}),function:T,object:T};return L.formatters=Object.assign(Object.assign({},I),L.formatters),L.delimiter=L.delimiter||",",L.eol=L.eol||`
`,L.header=L.header!==!1,L.includeEmptyRows=L.includeEmptyRows||!1,L.withBOM=L.withBOM||!1,L}preprocessFieldsInfo(E,L){return E.map(A=>{if(typeof A=="string")return{label:A,value:T=>d(T,A,L)};if(typeof A=="object"){const T="default"in A?A.default:L;if(typeof A.value=="string"){const I=A.value;return{label:A.label||A.value,value:N=>d(N,I,T)}}if(typeof A.value=="function"){const I=A.label||A.value.name||"",N={label:I,default:T},C=A.value;return{label:I,value(u){const n=C(u,N);return n===void 0?T:n}}}}throw new Error("Invalid field info option. "+JSON.stringify(A))})}getHeader(){return M(this.opts.fields.map(E=>this.opts.formatters.header(E.label)),this.opts.delimiter)}preprocessRow(E){return this.opts.transforms.reduce((L,A)=>L.map(T=>A(T)).reduce(p,[]),[E])}processRow(E){if(!E)return;const L=this.opts.fields.map(A=>this.processCell(E,A));if(!(!this.opts.includeEmptyRows&&L.every(A=>A==="")))return M(L,this.opts.delimiter)}processCell(E,L){return this.processValue(L.value(E))}processValue(E){const L=this.opts.formatters[typeof E];return L(E)}}class $ extends r{constructor(E){super(E)}parse(E){const L=this.preprocessData(E);this.opts.fields=this.opts.fields||this.preprocessFieldsInfo(L.reduce((N,C)=>(Object.keys(C).forEach(u=>{N.includes(u)||N.push(u)}),N),[]),this.opts.defaultValue);const A=this.opts.header?this.getHeader():"",T=this.processData(L);return(this.opts.withBOM?"\uFEFF":"")+A+(A&&T?this.opts.eol:"")+T}preprocessData(E){const L=Array.isArray(E)?E:[E];if(!this.opts.fields){if(E==null||L.length===0)throw new Error('Data should not be empty or the "fields" option should be included');if(typeof L[0]!="object")throw new Error('Data items should be objects or the "fields" option should be included')}return this.opts.transforms.length===0?L:L.map(A=>this.preprocessRow(A)).reduce(p,[])}processData(E){return M(E.map(L=>this.processRow(L)).filter(L=>L),this.opts.eol)}}var R;(function(_){_[_.BACKSPACE=8]="BACKSPACE",_[_.FORM_FEED=12]="FORM_FEED",_[_.NEWLINE=10]="NEWLINE",_[_.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",_[_.TAB=9]="TAB",_[_.SPACE=32]="SPACE",_[_.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",_[_.QUOTATION_MARK=34]="QUOTATION_MARK",_[_.NUMBER_SIGN=35]="NUMBER_SIGN",_[_.DOLLAR_SIGN=36]="DOLLAR_SIGN",_[_.PERCENT_SIGN=37]="PERCENT_SIGN",_[_.AMPERSAND=38]="AMPERSAND",_[_.APOSTROPHE=39]="APOSTROPHE",_[_.LEFT_PARENTHESIS=40]="LEFT_PARENTHESIS",_[_.RIGHT_PARENTHESIS=41]="RIGHT_PARENTHESIS",_[_.ASTERISK=42]="ASTERISK",_[_.PLUS_SIGN=43]="PLUS_SIGN",_[_.COMMA=44]="COMMA",_[_.HYPHEN_MINUS=45]="HYPHEN_MINUS",_[_.FULL_STOP=46]="FULL_STOP",_[_.SOLIDUS=47]="SOLIDUS",_[_.DIGIT_ZERO=48]="DIGIT_ZERO",_[_.DIGIT_ONE=49]="DIGIT_ONE",_[_.DIGIT_TWO=50]="DIGIT_TWO",_[_.DIGIT_THREE=51]="DIGIT_THREE",_[_.DIGIT_FOUR=52]="DIGIT_FOUR",_[_.DIGIT_FIVE=53]="DIGIT_FIVE",_[_.DIGIT_SIX=54]="DIGIT_SIX",_[_.DIGIT_SEVEN=55]="DIGIT_SEVEN",_[_.DIGIT_EIGHT=56]="DIGIT_EIGHT",_[_.DIGIT_NINE=57]="DIGIT_NINE",_[_.COLON=58]="COLON",_[_.SEMICOLON=59]="SEMICOLON",_[_.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",_[_.EQUALS_SIGN=61]="EQUALS_SIGN",_[_.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",_[_.QUESTION_MARK=63]="QUESTION_MARK",_[_.COMMERCIAL_AT=64]="COMMERCIAL_AT",_[_.LATIN_CAPITAL_LETTER_A=65]="LATIN_CAPITAL_LETTER_A",_[_.LATIN_CAPITAL_LETTER_B=66]="LATIN_CAPITAL_LETTER_B",_[_.LATIN_CAPITAL_LETTER_C=67]="LATIN_CAPITAL_LETTER_C",_[_.LATIN_CAPITAL_LETTER_D=68]="LATIN_CAPITAL_LETTER_D",_[_.LATIN_CAPITAL_LETTER_E=69]="LATIN_CAPITAL_LETTER_E",_[_.LATIN_CAPITAL_LETTER_F=70]="LATIN_CAPITAL_LETTER_F",_[_.LATIN_CAPITAL_LETTER_G=71]="LATIN_CAPITAL_LETTER_G",_[_.LATIN_CAPITAL_LETTER_H=72]="LATIN_CAPITAL_LETTER_H",_[_.LATIN_CAPITAL_LETTER_I=73]="LATIN_CAPITAL_LETTER_I",_[_.LATIN_CAPITAL_LETTER_J=74]="LATIN_CAPITAL_LETTER_J",_[_.LATIN_CAPITAL_LETTER_K=75]="LATIN_CAPITAL_LETTER_K",_[_.LATIN_CAPITAL_LETTER_L=76]="LATIN_CAPITAL_LETTER_L",_[_.LATIN_CAPITAL_LETTER_M=77]="LATIN_CAPITAL_LETTER_M",_[_.LATIN_CAPITAL_LETTER_N=78]="LATIN_CAPITAL_LETTER_N",_[_.LATIN_CAPITAL_LETTER_O=79]="LATIN_CAPITAL_LETTER_O",_[_.LATIN_CAPITAL_LETTER_P=80]="LATIN_CAPITAL_LETTER_P",_[_.LATIN_CAPITAL_LETTER_Q=81]="LATIN_CAPITAL_LETTER_Q",_[_.LATIN_CAPITAL_LETTER_R=82]="LATIN_CAPITAL_LETTER_R",_[_.LATIN_CAPITAL_LETTER_S=83]="LATIN_CAPITAL_LETTER_S",_[_.LATIN_CAPITAL_LETTER_T=84]="LATIN_CAPITAL_LETTER_T",_[_.LATIN_CAPITAL_LETTER_U=85]="LATIN_CAPITAL_LETTER_U",_[_.LATIN_CAPITAL_LETTER_V=86]="LATIN_CAPITAL_LETTER_V",_[_.LATIN_CAPITAL_LETTER_W=87]="LATIN_CAPITAL_LETTER_W",_[_.LATIN_CAPITAL_LETTER_X=88]="LATIN_CAPITAL_LETTER_X",_[_.LATIN_CAPITAL_LETTER_Y=89]="LATIN_CAPITAL_LETTER_Y",_[_.LATIN_CAPITAL_LETTER_Z=90]="LATIN_CAPITAL_LETTER_Z",_[_.LEFT_SQUARE_BRACKET=91]="LEFT_SQUARE_BRACKET",_[_.REVERSE_SOLIDUS=92]="REVERSE_SOLIDUS",_[_.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",_[_.CIRCUMFLEX_ACCENT=94]="CIRCUMFLEX_ACCENT",_[_.LOW_LINE=95]="LOW_LINE",_[_.GRAVE_ACCENT=96]="GRAVE_ACCENT",_[_.LATIN_SMALL_LETTER_A=97]="LATIN_SMALL_LETTER_A",_[_.LATIN_SMALL_LETTER_B=98]="LATIN_SMALL_LETTER_B",_[_.LATIN_SMALL_LETTER_C=99]="LATIN_SMALL_LETTER_C",_[_.LATIN_SMALL_LETTER_D=100]="LATIN_SMALL_LETTER_D",_[_.LATIN_SMALL_LETTER_E=101]="LATIN_SMALL_LETTER_E",_[_.LATIN_SMALL_LETTER_F=102]="LATIN_SMALL_LETTER_F",_[_.LATIN_SMALL_LETTER_G=103]="LATIN_SMALL_LETTER_G",_[_.LATIN_SMALL_LETTER_H=104]="LATIN_SMALL_LETTER_H",_[_.LATIN_SMALL_LETTER_I=105]="LATIN_SMALL_LETTER_I",_[_.LATIN_SMALL_LETTER_J=106]="LATIN_SMALL_LETTER_J",_[_.LATIN_SMALL_LETTER_K=107]="LATIN_SMALL_LETTER_K",_[_.LATIN_SMALL_LETTER_L=108]="LATIN_SMALL_LETTER_L",_[_.LATIN_SMALL_LETTER_M=109]="LATIN_SMALL_LETTER_M",_[_.LATIN_SMALL_LETTER_N=110]="LATIN_SMALL_LETTER_N",_[_.LATIN_SMALL_LETTER_O=111]="LATIN_SMALL_LETTER_O",_[_.LATIN_SMALL_LETTER_P=112]="LATIN_SMALL_LETTER_P",_[_.LATIN_SMALL_LETTER_Q=113]="LATIN_SMALL_LETTER_Q",_[_.LATIN_SMALL_LETTER_R=114]="LATIN_SMALL_LETTER_R",_[_.LATIN_SMALL_LETTER_S=115]="LATIN_SMALL_LETTER_S",_[_.LATIN_SMALL_LETTER_T=116]="LATIN_SMALL_LETTER_T",_[_.LATIN_SMALL_LETTER_U=117]="LATIN_SMALL_LETTER_U",_[_.LATIN_SMALL_LETTER_V=118]="LATIN_SMALL_LETTER_V",_[_.LATIN_SMALL_LETTER_W=119]="LATIN_SMALL_LETTER_W",_[_.LATIN_SMALL_LETTER_X=120]="LATIN_SMALL_LETTER_X",_[_.LATIN_SMALL_LETTER_Y=121]="LATIN_SMALL_LETTER_Y",_[_.LATIN_SMALL_LETTER_Z=122]="LATIN_SMALL_LETTER_Z",_[_.LEFT_CURLY_BRACKET=123]="LEFT_CURLY_BRACKET",_[_.VERTICAL_LINE=124]="VERTICAL_LINE",_[_.RIGHT_CURLY_BRACKET=125]="RIGHT_CURLY_BRACKET",_[_.TILDE=126]="TILDE"})(R||(R={}));R.QUOTATION_MARK+"",R.QUOTATION_MARK,R.REVERSE_SOLIDUS+"",R.REVERSE_SOLIDUS,R.SOLIDUS+"",R.SOLIDUS,R.LATIN_SMALL_LETTER_B+"",R.BACKSPACE,R.LATIN_SMALL_LETTER_F+"",R.FORM_FEED,R.LATIN_SMALL_LETTER_N+"",R.NEWLINE,R.LATIN_SMALL_LETTER_R+"",R.CARRIAGE_RETURN,R.LATIN_SMALL_LETTER_T+"",R.TAB;var U;(function(_){_[_.LEFT_BRACE=0]="LEFT_BRACE",_[_.RIGHT_BRACE=1]="RIGHT_BRACE",_[_.LEFT_BRACKET=2]="LEFT_BRACKET",_[_.RIGHT_BRACKET=3]="RIGHT_BRACKET",_[_.COLON=4]="COLON",_[_.COMMA=5]="COMMA",_[_.TRUE=6]="TRUE",_[_.FALSE=7]="FALSE",_[_.NULL=8]="NULL",_[_.STRING=9]="STRING",_[_.NUMBER=10]="NUMBER",_[_.SEPARATOR=11]="SEPARATOR"})(U||(U={}));var G;(function(_){_[_.START=0]="START",_[_.ENDED=1]="ENDED",_[_.ERROR=2]="ERROR",_[_.TRUE1=3]="TRUE1",_[_.TRUE2=4]="TRUE2",_[_.TRUE3=5]="TRUE3",_[_.FALSE1=6]="FALSE1",_[_.FALSE2=7]="FALSE2",_[_.FALSE3=8]="FALSE3",_[_.FALSE4=9]="FALSE4",_[_.NULL1=10]="NULL1",_[_.NULL2=11]="NULL2",_[_.NULL3=12]="NULL3",_[_.STRING_DEFAULT=13]="STRING_DEFAULT",_[_.STRING_AFTER_BACKSLASH=14]="STRING_AFTER_BACKSLASH",_[_.STRING_UNICODE_DIGIT_1=15]="STRING_UNICODE_DIGIT_1",_[_.STRING_UNICODE_DIGIT_2=16]="STRING_UNICODE_DIGIT_2",_[_.STRING_UNICODE_DIGIT_3=17]="STRING_UNICODE_DIGIT_3",_[_.STRING_UNICODE_DIGIT_4=18]="STRING_UNICODE_DIGIT_4",_[_.STRING_INCOMPLETE_CHAR=19]="STRING_INCOMPLETE_CHAR",_[_.NUMBER_AFTER_INITIAL_MINUS=20]="NUMBER_AFTER_INITIAL_MINUS",_[_.NUMBER_AFTER_INITIAL_ZERO=21]="NUMBER_AFTER_INITIAL_ZERO",_[_.NUMBER_AFTER_INITIAL_NON_ZERO=22]="NUMBER_AFTER_INITIAL_NON_ZERO",_[_.NUMBER_AFTER_FULL_STOP=23]="NUMBER_AFTER_FULL_STOP",_[_.NUMBER_AFTER_DECIMAL=24]="NUMBER_AFTER_DECIMAL",_[_.NUMBER_AFTER_E=25]="NUMBER_AFTER_E",_[_.NUMBER_AFTER_E_AND_SIGN=26]="NUMBER_AFTER_E_AND_SIGN",_[_.NUMBER_AFTER_E_AND_DIGIT=27]="NUMBER_AFTER_E_AND_DIGIT",_[_.SEPARATOR=28]="SEPARATOR",_[_.BOM_OR_START=29]="BOM_OR_START",_[_.BOM=30]="BOM"})(G||(G={}));var D;(function(_){_[_.OBJECT=0]="OBJECT",_[_.ARRAY=1]="ARRAY"})(D||(D={}));var P;(function(_){_[_.VALUE=0]="VALUE",_[_.KEY=1]="KEY",_[_.COLON=2]="COLON",_[_.COMMA=3]="COMMA",_[_.ENDED=4]="ENDED",_[_.ERROR=5]="ERROR",_[_.SEPARATOR=6]="SEPARATOR"})(P||(P={}));const x={key:0},j=B({__name:"DownloadData",props:{query:null,dlFileName:{type:String,required:!1}},setup(_){const E=m(!1),L=_,A=async function(){E.value=!0;const{data:I}=await L.query,C=new $().parse(I),u=new Blob([C],{type:"text/csv"}),n=L.dlFileName||"report.csv";T(u,n),E.value=!1},T=function(I,N,C=!1){const u=URL.createObjectURL(I),n=document.createElement("a");n.href=u,C||(n.download=N||"download");const O=()=>{setTimeout(()=>{URL.revokeObjectURL(u),n.removeEventListener("click",O)},150)};return n.addEventListener("click",O,!1),n.click(),n};return(I,N)=>E.value?(o(),i("span",x,"Loading...")):(o(),i("a",{key:1,type:"download",title:"download report",onClick:N[0]||(N[0]=C=>A())},[b(g(v),{class:"inline-block h-8 w-8 text-blue-500 hover:text-blue-800"})]))}});export{j as _};
