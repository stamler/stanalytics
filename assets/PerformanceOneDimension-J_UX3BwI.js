import{_ as T,O as U}from"./SizeWarning.vue_vue_type_script_setup_true_lang-3JY7Zej9.js";import{o as m,c as x,a as _,d as R,u as F,s as N,r as o,w as q,q as O,t as $,k as r,y as h,e as n,p as v,z as d,l as j,F as H,h as P,g as A,i as Q,A as Z}from"./index-BAAfU4mb.js";import{_ as z,c as i}from"./RefreshButton.vue_vue_type_script_setup_true_lang-BZ1PaPHp.js";import"./_commonjsHelpers-Cpj98o6Y.js";function E(g,k){return m(),x("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[_("path",{"fill-rule":"evenodd",d:"M15.97 2.47a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1 0 1.06l-4.5 4.5a.75.75 0 1 1-1.06-1.06l3.22-3.22H7.5a.75.75 0 0 1 0-1.5h11.69l-3.22-3.22a.75.75 0 0 1 0-1.06Zm-7.94 9a.75.75 0 0 1 0 1.06l-3.22 3.22H16.5a.75.75 0 0 1 0 1.5H4.81l3.22 3.22a.75.75 0 1 1-1.06 1.06l-4.5-4.5a.75.75 0 0 1 0-1.06l4.5-4.5a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}const I={class:"bg-neutral-700 p-4 text-2xl font-bold text-neutral-300"},M={class:"bg-neutral-100"},G={class:"flex w-screen flex-wrap gap-1 p-2 md:w-full"},X=R({__name:"PerformanceOneDimension",props:{objectTableProps:{type:Object,default:()=>({})},name:{type:String,required:!0},dbFunction:{type:null,required:!0},dimension:{type:String,required:!0},value:{type:String,required:!1},startDate:{type:String,required:!1},endDate:{type:String,required:!1}},setup(g){const k=F(),{preferences:c}=N(k),l=g,D=new Date(Date.now()-24*60*60*1e3).toISOString().split("T")[0],e=l.value?o(l.value):o(""),s=l.startDate?o(l.startDate):o(D),u=l.endDate?o(l.endDate):o(D),b=o([]),f=o(!1),y=P(),w=A(),V=o(!0);q([e,s,u,y],()=>{V.value=!0}),q([c,y],()=>{if(!y.params.value)switch(l.dimension){case"brand":e.value=c.value.defaultBrand||"";break;case"sku":e.value=c.value.defaultSku||"";break;case"store":e.value=c.value.defaultStore||"";break;case"supplier":e.value=c.value.defaultSupplier||"";break;case"type":e.value=c.value.defaultType||"";break}},{immediate:!0});const S=()=>{const p=w.currentRoute.value.name,a=p==null?void 0:p.split(" By ");return`${a[1]}s By ${a[0].slice(0,-1)}`};async function C(){w.push({params:{dimension:l.dimension,value:e.value,startDate:s.value,endDate:u.value}}),f.value=!0;const p=Q.rpc(l.dbFunction,{_dimension:l.dimension,_value:e.value,_start_date:s.value,_end_date:u.value}),{data:a}=await p;b.value=a||[],f.value=!1,V.value=!1}return(p,a)=>{const B=Z("router-link");return m(),x(H,null,[_("h1",I,[O($(l.name)+" ",1),r(T,{tableData:b.value},null,8,["tableData"]),r(B,{class:"inline-block w-5",to:{name:S(),params:{startDate:n(s),endDate:n(u)}}},{default:h(()=>[r(n(E))]),_:1},8,["to"])]),_("div",M,[_("div",G,[r(z,{onClick:C,loading:f.value,dirty:V.value},null,8,["loading","dirty"]),l.dimension==="brand"?(m(),v(i,{key:0,modelValue:n(e),"onUpdate:modelValue":a[0]||(a[0]=t=>d(e)?e.value=t:null),table:"sqdc_brands",name_col:"brand",value_col:"brand"},null,8,["modelValue"])):l.dimension==="sku"?(m(),v(i,{key:1,modelValue:n(e),"onUpdate:modelValue":a[1]||(a[1]=t=>d(e)?e.value=t:null),table:"sqdc_skus",name_col:"slug",value_col:"sku"},null,8,["modelValue"])):l.dimension==="store"?(m(),v(i,{key:2,modelValue:n(e),"onUpdate:modelValue":a[2]||(a[2]=t=>d(e)?e.value=t:null),table:"sqdc_stores_latest",order_col:"name",name_col:"name",value_col:"number"},null,8,["modelValue"])):l.dimension==="supplier"?(m(),v(i,{key:3,modelValue:n(e),"onUpdate:modelValue":a[3]||(a[3]=t=>d(e)?e.value=t:null),table:"sqdc_suppliers",name_col:"supplier",value_col:"supplier"},null,8,["modelValue"])):l.dimension==="type"?(m(),v(i,{key:4,modelValue:n(e),"onUpdate:modelValue":a[4]||(a[4]=t=>d(e)?e.value=t:null),table:"sqdc_product_types",name_col:"type",value_col:"type"},null,8,["modelValue"])):j("",!0),r(i,{modelValue:n(s),"onUpdate:modelValue":a[5]||(a[5]=t=>d(s)?s.value=t:null),table:"sqdc_inventory_movements_dates",name_col:"date",value_col:"date"},null,8,["modelValue"]),r(i,{modelValue:n(u),"onUpdate:modelValue":a[6]||(a[6]=t=>d(u)?u.value=t:null),table:"sqdc_inventory_movements_dates",name_col:"date",value_col:"date"},null,8,["modelValue"])]),r(U,{class:"md:p-2",tableData:b.value,tableConfig:{columnFormatters:{market_share:"percent",value_out:"dollars",value_in:"dollars",total_out:"dollars"},omitColumns:l.objectTableProps.omitCols||[]}},null,8,["tableData","tableConfig"])])],64)}}});export{X as default};
